<h1>Account: <%= @account.name %></h1>

<% @companies = @account.active_companies.sort_by {|c| -c.account_market_value} %>

<%
# calculate the average percent gain for active companies
avg_gain = 0
@companies.each do |c|
	avg_gain += c.account_gain_percent
end
avg_gain = avg_gain / @companies.count()
%>

<%= render 'companies/big5_list', companies: @companies, account: @account %>

<br>
<strong>avg gain:</strong> <%= number_with_precision(avg_gain, precision: 1) %>%
<br>
<strong>capital gain:</strong> <%= number_with_precision(@account.gain_percent, precision: 1) %>% <%= number_to_currency(@account.gain_amount) %>

<br>
<strong>market value:</strong> <%= number_to_currency(@account.market_value) %>

<br>
<%= link_to 'pull complete financials for these companies', updateCompanies_url(company_ids: @companies) %>

<% @companies = @account.inactive_companies.sort_by {|c| -c.account_gain_amount} %>
<% if @companies.count() > 0 %>
<br>
<br>
<br>
<br>
<br>
<h2>Oldies</h2>
<%= render 'companies/big5_list', companies: @companies, account: @account %>
<% end %>
